var domObserver,domObserverLight,infiniteLoopPreventCounter=0,myTimer=0,wasNotStoped=!0,punish=(e,t)=>{const o=(e,t)=>window.getComputedStyle(e,null).getPropertyValue(t),n=(e,t,o)=>e.style.setProperty(t,o,"important"),r=(e,t)=>!!e.includes(t),s=e=>{let t={...e};return isNaN(e.cleanedArea)&&(t={...d,cleanedArea:0}),isNaN(e.numbOfItems)&&(t={...d,numbOfItems:0}),isNaN(e.restored)&&(t={...d,restored:0}),t},i=e=>chrome.storage.sync.get(["stats"],t=>{const o=Math.round(e.cleanedArea/e.windowArea*10)/10;let n={cleanedArea:t.stats.cleanedArea+o,numbOfItems:t.stats.numbOfItems+e.numbOfItems,restored:t.stats.restored+e.restored};(isNaN(n.cleanedArea)||isNaN(n.numbOfItems)||isNaN(n.restored))&&(n=s(n)),chrome.storage.sync.set({stats:n})}),a=e=>({...e,numbOfItems:e.numbOfItems+1});let d=e?{windowArea:window.innerHeight*window.innerWidth,cleanedArea:0,numbOfItems:0,restored:0}:null;const m=document.documentElement,l=document.body,c=l.getElementsByTagName("*"),u=()=>{o(m,"overflow-y")&&(n(m,"overflow-y","unset"),e&&(d=a(d))),o(l,"overflow-y")&&(n(l,"overflow-y","unset"),e&&(d=a(d)));const t=o(m,"position");"fixed"!=t&&"absolute"!=t||(n(m,"position","relative"),e&&(d=a(d)));const r=o(l,"position");"fixed"!=r&&"absolute"!=r||(n(l,"position","relative"),e&&(d=a(d)))},f=t=>{const r=o(t,"position");if("fixed"==r||"sticky"==r){if("notification"===t.getAttribute("data-PopUpOFF"))return;if("none"!=o(t,"display")&&t.setAttribute("data-popupoffExtension","hello"),e){const e=t.offsetHeight*t.offsetWidth;d=isNaN(e)?d:{...d,numbOfItems:d.numbOfItems+1,cleanedArea:d.cleanedArea+e}}n(t,"display","none"),setTimeout(()=>!!t&&n(t,"display","none"),10)}"none"==o(t,"filter")&&"none"==o(t,"-webkit-filter")||(n(t,"filter","none"),n(t,"-webkit-filter","none"),e&&(d=a(d)))},b=e=>{[...e].map(f)},p=e=>{if(e instanceof HTMLElement&&(f(e),wasNotStoped)){const t=e.querySelectorAll("*");b(t)}},y=()=>{infiniteLoopPreventCounter=0,clearTimeout(myTimer),myTimer=0},v=e=>{p(e.target),[...e.addedNodes].map(e=>{"#text"!=e.nodeName&&"#comment"!=e.nodeName&&p(e)}),u()},g=()=>infiniteLoopPreventCounter>1200?((()=>{try{domObserver.disconnect(),domObserver=!1,wasNotStoped&&setTimeout(()=>{const e=document.body.getElementsByTagName("*");N(e)},2e3),wasNotStoped=!1,domObserverLight.disconnect()}catch(e){}})(),!0):(infiniteLoopPreventCounter++,0===myTimer&&(myTimer=setTimeout(y,1e3)),!1),h=t=>{(e=>{e.target.style.removeProperty("height")})(t),"childList"===t.type&&t.removedNodes.length&&(t=>{const o=t.target,n=t.removedNodes.length;for(let e=0;e<n;e++){const n=t.removedNodes[e].cloneNode(!0);if(n instanceof Element&&"notification"===n.getAttribute("data-PopUpOFF"))return;o.appendChild(n)}o.style.removeProperty("height"),o.style.removeProperty("margin"),o.style.removeProperty("padding"),e&&(d={...d,restored:d.restored+1})})(t)},N=e=>{u(),b(e),domObserver||(domObserver=new MutationObserver(e=>{let o=[];const n=e.length;for(let s=0;s<n&&!g();s++){const n=e[s];if(t)h(n);else{if(r(o,n.target))continue;o=[...o,n.target]}v(n)}})),window.location.href.includes("pinterest")?((domObserverLight=new MutationObserver(e=>{e.map(u)})).observe(m,{attributes:!0}),domObserverLight.observe(l,{attributes:!0})):domObserver.observe(m,{childList:!0,subtree:!0,attributes:!0})};N(c),e&&(i(d),window.addEventListener("beforeunload",()=>{i(d)}))};chrome.storage.sync.get(["statsEnabled","restoreCont"],e=>{punish(e.statsEnabled,e.restoreCont)});
